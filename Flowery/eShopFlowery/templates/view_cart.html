{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <title>ShoppingCart</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <link href="path/to/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,500,0,200" />
    <link href='https://fonts.googleapis.com/css?family=Varela Round' rel='stylesheet'>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,600,0,0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
    body
    {
        font-family: Verdana;
    }
     .btn-pink {
            background-color: #B61536;
            color: white;
            border-color:  #B61536;
            padding-left: 20px;
            padding-right: 20px;

        }

        .btn-pink:hover {
            background-color: #76081F;
            color: #ffffff;
        }
         .navbar-nav
        {

            display: flex;
            justify-content: space-between;
            width: 100%;
        }
                 .site-footer {
            background-color:#F3DBDB;
            padding: 40px 0;
            color: black;
            margin-top: 50px;

        }

        .site-footer h3 {
            font-size: 18px;
            margin-bottom: 20px;
        }

        .site-footer p {
            font-size: 14px;
        }

        .social-icons {
            list-style: none;
            padding: 0;
            display: flex;
        }

        .social-icons li {
            margin-right: 10px;
        }

        .social-icons a {
            color: black;
            font-size: 24px;
            transition: color 0.3s ease;
        }

        .social-icons a:hover {
            color: #f39c12;
        }
</style>
</head>
<body>
<nav class="navbar  " style="display: flex; align-items: center;">
    <div class="container">
       <a href="{% url 'index' %}" style="text-decoration: none"><h1 class="navbar-brand mb-0 h1" style=";font-size: 30px;font-family: Varela Round">Flowery<span style="color: #B61536; font-size: 70px">.</span></h1></a>

        <div class="d-flex text-align " >
                   <span class="navigation">
                       <a href="{% url 'customer_login' %}" style="display: inline-block;color: black; vertical-align: middle;"><span style="font-size: 30px;display: inline-block; vertical-align: middle;" class="material-symbols-outlined">person</span></a>
                   </span>
                  <a href="{% url 'view_cart' %}" style="color: black"><span class="material-symbols-outlined navigation"style="font-size: 30px; vertical-align: middle;">shopping_cart</span></a>
            <a href="{% url 'favorite' %}" style="color:black;"> <span class="material-symbols-outlined navigation" style="font-size: 30px; vertical-align: middle;">favorite</span></a>
        </div>
    </div>
</nav>
<img src="{% static 'templateimg.png' %}" style="width: 100%;margin-top: -80px;">
<nav class="navbar navbar-expand-lg ">
  <div class="container">

      <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav" style="font-size: 20px; ">
        <li class="nav-item">
          <a aria-current="page" href="{% url 'products' %}?occasion=all" class="nav-link {% if occasion == 'all' %}active{% endif %}">All</a>
        </li>
        <li class="nav-item">
          <a aria-current="page" href="{% url 'products' %}?occasion=Weeding" class=" nav-link {% if occasion == 'Weeding' %}active{% endif %}">Weeding</a>
        </li>
        <li class="nav-item">
          <a  aria-current="page" href="{% url 'products' %}?occasion=Graduation" class=" nav-link {% if occasion == 'Graduation' %}active{% endif %}">Graduation</a>
        </li>
        <li class="nav-item">
          <a  aria-current="page" href="{% url 'products' %}?occasion=Anniversary" class=" nav-link {% if occasion == 'Anniversary' %}active{% endif %}">Anniversary</a>
        </li>
           <li class="nav-item">
          <a aria-current="page" href="{% url 'products' %}?occasion=Birthday" class=" nav-link {% if occasion == 'Birthday' %}active{% endif %}">Birthday</a>
        </li>
           <li class="nav-item">
          <a  aria-current="page" href="{% url 'products' %}?occasion=Motherday" class=" nav-link {% if occasion == 'Motherday' %}active{% endif %}">Mother's day</a>
        </li>
      </ul>
    </div>

</div>
</nav>

{% block content %}

<div class="container" style="margin-top: 50px">
    <h3>Your Shopping Cart</h3>
</div>

<div class="container" style="background-color: #F3DBDB; padding: 20px;">
    {% if product_quantity %}
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Name</th>
                    <th>Price</th>
                    <th>No. flowers</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
               {% for product, quantity in product_quantity %}
                <tr>
                    <td><img src="{{ product.image.url }}" alt="{{ product.name }}" style="max-width: 100px;"></td>
                    <td>{{ product.name }}</td>
                    <td>{{ product.price }} ден.</td>
                    <td>{{ quantity}}</td>
                    <td><button class="btn btn-danger btn-sm removee" data-product-code="{{ product.code }}"  data-quantity="{{ quantity }}">Remove</button></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div style="text-align: right;">
            <h5>Total: {{ total }} ден.</h5>
            <a href="{% url 'address' %}" class="btn btn-pink">Order</a>
        </div>
    {% else %}
        <div class="text-center">
            <h5>Your cart is empty.</h5>
        </div>
    {% endif %}
</div>

{% endblock %}

<footer class="site-footer" style="margin-top: 200px;text-align: justify ">
    <div class="container">
        <div class="row footer">
            <div class="col-md-4">
                <h3>About Us</h3>
                <p>Discover the art of expression at Flowery.
                    We specialize in crafting stunning bouquets that convey emotions words can't capture.Explore a world of vibrant colors and delicate fragrances as you browse our handpicked collection of fresh flowers.
                    From joyful celebrations to heartfelt moments, we offer nature's finest creations to express your emotions.  </p>
            </div>
            <div class="col-md-4">
                <h3>Contact us</h3>
                <p>For more information please feel free to contact us.</p>
                <p>Phone number:+38970 123 456</p>
                <p>Email: flowery@gmail.com</p>
                <ul class="social-icons">
                    <li><a href="#"><i class="fab fa-facebook"></i></a></li>
                    <li><a href="#"><i class="fab fa-twitter"></i></a></li>
                    <li><a href="#"><i class="fab fa-instagram"></i></a></li>
                </ul>
            </div>
            <div class="col-md-4 mb-md-0 mb-4">
                <h3>Delivery Information</h3>
                <p>Free Shipping on orders over 3000ден.</p>
                <p>Estimated delivery: 3-5 business days</p>
                <p>For more information contact us.</p>
            </div>
        </div>
    </div>
</footer>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>

$(document).ready(function() {
    $(".removee").click(function() {
        var itemId = $(this).data('product-code');
        var quantity = $(this).data('quantity');
        $.ajax({
            url: "{% url 'remove_item' %}",
            method: "POST",
             headers: { "X-CSRFToken": "{{ csrf_token }}" },  // Include the CSRF token
             data: { product_code: itemId, quantity: quantity },

            success: function(data) {
                if (data.success) {
                      location.reload();
                } else {
                    alert("Failed to remove item.");
                }
            },
            error: function() {
                alert("An error occurred.");
            }
        });
    });
});
</script>
</body>
</html>